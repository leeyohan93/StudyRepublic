<!-- 
  @author 윤원식
  @since 2019. 1. 24.
  @version
  -list.html 추가
 -->

<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/layout/boardLayout}">

<div layout:fragment="content">

   <div class="panel-heading">자유게시판아아</div>

<div th:with="result=${list.list}">


	<table class="table table-striped table-boardered table-hover"
		id="dataTables-example">
		<thead>
			<tr>
				<th>번호</th>
				<th>제목</th>
				<th>작성자</th>
				<th>작성일</th>
				<th>조회수</th>
				<th>추천</th>
		</thead>


		<tbody>
			<tr class="odd gradeX" th:each="board:${result.content}">
				<td>[[${board.freeBoardId}]]</td>
				<td><a th:href='${board.freeBoardId}' class='boardLink'>[[${board.title}]]</a></td>
				<td>[[${board.id}]]</td>
				<td class="center">[[${#dates.format(board.date,'yyyy-MM-dd')}]]</td>
				<td>[[${board.likeCount}]]</td>
				<td>[[${board.replyCount}]]</td>

			</tr>
		</tbody>
	</table>
	
	
	<div>
	<select id='searchType'>
          <option value ='all' th:selected="${pageDTO.searchType} =='all'">제목+내용</option>
          <option value ='title' th:selected="${pageDTO.searchType} =='title'">제목</option>
          <option value ='content' th:selected="${pageDTO.searchType} =='content'">내용</option>
          <option value ='writer' th:selected="${pageDTO.searchType} =='writer'">작성자</option>
	</select>
	<input type ='text' id='keyword' th:value="${pageDTO.keyword}"placeholder="검색어를 입력해주세요.">
	<button id ='searchBtn'>검색</button>
	
	
	</div>
	
	<a th:href="@{boardWrite}">글쓰기</a>
	
	
	
</div>


<!-- 페이징   -->

<nav>
	<div>
		<ul class="pagination">
			
			<li th:if="${list.prevPage}"><a th:href="${list.prevPage.pageNumber} + 1">PREV [[${list.prevPage.pageNumber} + 1]]</a>
			<li th:each="p:${list.pageList}"><a th:href="${p.pageNumber} +1">[[${p.pageNumber} + 1]]</a></li>
			
			<li th:if="${list.nextPage}"><a th:href="${list.nextPage.pageNumber}+ 1">NEXT [[${list.nextPage.pageNumber} + 1]]</a>

		</ul>
	</div>
</nav>

<form id='f1' th:action="@{listFreeBoard}" method="get">
	<input type='hidden' name='page' th:value=${list.currentPageNum}>
	<input type='hidden' name='size' th:value=${list.currentPage.pageSize}>
	<input type='hidden' name='searchType' th:value=${pageDTO.searchType}>
	<input type='hidden' name='keyword' th:value=${pageDTO.keyword}>

</form>

</div>

<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
	
<script th:inline="javascript">

     $(document).ready(function() {
		var formObj = $("#f1");

		$(".pagination a").click(function(e) {

			e.preventDefault();

			formObj.find('[name="page"]').val($(this).attr('href'));

			formObj.submit();
		});
		
		
		$(".boardLink").click(function(e){
			
			e.preventDefault();
			
			var boardNo = $(this).attr("href");
			
			formObj.attr("action",[[@{'/board/viewFreeBoard'}]]);
			formObj.append("<input type='hidden' name='freeBoardId' value='"+ boardNo + "'>");
			
			formObj.submit();
		});
		
		
		
		
		$("#searchBtn").click(function(e){
			
			var typeStr = $("#searchType").find(":selected").val();
			var keywordStr = $("#keyword").val();
			
			console.log(typeStr, "" , keywordStr);
			
			formObj.find("[name='searchType']").val(typeStr);
			formObj.find("[name='keyword']").val(keywordStr);
			formObj.find("[name='page']").val("1");
			formObj.submit();
		});
	});
	
	
</script>