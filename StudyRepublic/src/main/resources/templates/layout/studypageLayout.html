<!DOCTYPE HTML>
<!--
	Phantom by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"
	layout:decorate="~{/layout/mainLayout}">
<head>
<title>Study Republic</title>
<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, user-scalable=no" />
<link rel = "stylesheet" type = "text/css" th:href = "@{/css/studymainpage.css}">
<div layout:fragment="bootCss">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css">
</div>
<div layout:fragment="bootJs">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>
  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"></script>
  	<script type="text/javascript" src="/smarteditor/js/HuskyEZCreator.js" charset="utf-8"></script>
</div>

</head>
<body>
	<nav layout:fragment="header-nav"></nav>
	<nav id="menu" layout:fragment="menu"></nav>
	<div id="main" layout:fragment="main"
		><div class="inner"
			><style>
					#leftDown{
						text-align:center;
					}
					.class{
						font-size: 70%;
					    font-weight: 900;
					    padding: 0px;
					}
					button{
						padding: 0px;
						font-size: 0.8em;
						background-color: black;
					}
				</style><div id="left" layout:fragment="left"
				>
				<div id="leftTop"><div id="studyTitleDiv"
					></div
				></div
				><div id="leftDown">
					<button class="check" value="/StudyPage/Main">home</button></br>
					<button class="check" value="/StudyPage/Noticeboard">공지사항</button></br>
					<button class="check" value="/StudyPage/Fileshareboard">파일 공유</button></br>
					<button class="check" value="/StudyPage/Qnaboard">질문 및 답변</button></br>
					<!-- <button th:href="@{#}">@{/StudyPage/VideoCalling}"화상 통화</button></br> -->
					<button class="check" id ="chatPage" th:href="@{#}">채팅</button></br
					><!-- <button class="check" th:if="${studyIdAndStatusCode.get('javascript:window.name')}=='리더'" value="/StudyPage/Management">관리</button></br> -->
					<!-- <button th:unless="${session.studyIdAndStatusCode.get('javascript:window.name')}=='승인'"  th:href="@{#}">탈퇴</button></br> -->
					<!-- <a th:href="@{#}">신고</a></br>
					-->
					<!-- <button class="check" th:if="${session.studyIdAndStatusKoreanMap.get('BB00001')}=='리더'">관리</button> -->
					<!-- <button class="check" th:if="${session.studyIdAndStatusKoreanMap.get('BB00001')}=='리더'">관리</button>  -->
					<form action="/index" id="formAction">
						<input type="hidden" name="" value=""></input>
						<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" /> 
					</form>
				</div
			></div
			><div id="right" layout:fragment="right"
				><div id="noticeBoard"></div
				><div id="joinMember"></div
				><div id="double"
					><div id="qnaBoard"
					></div
				><div id="ing"></div>
				</div>
				</div>
				
	        <script>
/* 	        $('document').ready(function(){
	        	$('.check').on('click', function(e){
	        		var form = $('#formAction');
	        		form.action = this.value;
	        		form[0].name = "studyId";
	        		form[0].value = window.name;
	        		console.log(form.action + '/' + form[0].name + '/' + form[0].value);
	        		alert("폼액션 - " + form.action);
	        		alert("");
//	        		form.submit();
	        		$('#formAction').submit();
	        	});
	        }); */
	        
	        var token = $("meta[name='_csrf']").attr("content");
			var header = $("meta[name='_csrf_header']").attr("content");
			$(function() {
				$(document).ajaxSend(
						function(e, xhr, options) {
							xhr.setRequestHeader(header,token);
						});
			});
			var d;
	        $('document').ready(function(){
	        	
	        	var studyInfo =  window.name;
		        console.log(studyInfo)
	        	
	        	$.ajax({
					type : "POST",
					contentType : "application/json; charset=UTF-8",
					url : "/StudyPage/PowerCheck",
					data : studyInfo,
					dataType : "json",
					success : function(data) {
						console.log("실행됨");
						d = data;
						$("#leftDown").append("<button class='check' value='" + data[0] + "'>" + data[1] + "</button></br>");
						$('.check').on('click', function(e){
			        		
			        		form = $('#formAction')[0];
			        		form.method = "POST";
			        		form.action = this.value;
			        		form[0].name = "studyId";
			        		form[0].value = window.name;
			        		console.log(form.action + '/' + form[0].name + '/' + form[0].value);
			        		form.submit();
			        	});
					},error : function(data) {
						console.log(data);
					}
				});
	        	
	        	
	        });
      
    var popOpen;
 
    //채팅 팝업 (원식)
    $('#chatPage').click(function(){
    	var popOption = "width=460px, height=735px, top=100px, left=650px;"
        popOpen = window.open("/chat/studyChat","chatPage", popOption);

    });
    //로그아웃 클릭시 팝업창 종료
	$('.logoutConfirm').click(function(){
		if(popOpen != null){ 
			popOpen.close();
		};
		
	})

    
    </script>
				</div>
	</div>

	<footer id="nonevisiblefooter" layout:fragment="footer"><div></div></footer>



	<!-- Scripts -->
	<!-- <script th:src="@{/assets/js/jquery.min.js}"></script>
	<script th:src="@{/assets/js/browser.min.js}"></script>
	<script th:src="@{/assets/js/breakpoints.min.js}"></script>
	<script th:src="@{/assets/js/util.js}"></script>
	<script th:src="@{/assets/js/main.js}"></script> -->
</body>
</html>